inc_id: INC002
server_id: SRV001
region: Europe West
date: 2025-04-11T09:14:32.412Z

# What happened?
Between 09:14 and 09:41 UTC a subset (~18%) of authentication requests to the production User Authentication API experienced elevated latency (p95 from 250ms to 4.2s) and intermittent 502 responses. Impact was confined to customers routed to our Europe West cluster; other regions operated normally.

# What went wrong and why?
A routine deployment introduced a regression in the API gateway configuration. A new rate‑limiting plugin was enabled with a default synchronous external call to a feature flag service. Under burst load this created head-of-line blocking threads waiting on the external lookup. When thread pools saturated, health checks degraded and the load balancer began cycling instances, amplifying the latency. A fallback path that should have short‑circuited to an in‑memory cache was misconfigured (flag namespace mismatch) so the cache was never hit.

# How did we respond?
* 09:16 UTC – Automated latency SLO alert fired (p95 > 1s) and on-call engaged.
* 09:19 UTC – Error budget burn rate alert (14d window) triggered; incident declared SEV2.
* 09:23 UTC – Identified recent gateway config change as suspect; began rollback.
* 09:27 UTC – Rolled back plugin activation; latency partially improved (p95 1.2s) but 502s persisted.
* 09:32 UTC – Discovered thread pool exhaustion due to external call; disabled external flag lookup.
* 09:38 UTC – Thread pools recovered; 502s ceased.
* 09:41 UTC – p95 returned to normal; incident resolved and monitoring for regression.

# How are we making incidents like this less likely or less impactful?
* Add pre-production chaos test injecting latency into external flag service (Completed)
* Enforce async + timeout + circuit breaker pattern for all gateway plugins (In progress – May 2025)
* Add config linter rule to block enabling plugins with external synchronous calls (Planned – April 2025)
* Extend synthetic checks to exercise new gateway config 5 min prior to production promotion (Planned – April 2025)
* Increase authentication gateway thread pool saturation alert sensitivity (Completed)

# How can customers make incidents like this less impactful?
* Implement client-side retries with exponential backoff and jitter for idempotent auth token retrieval.
* Cache short-lived auth tokens where policy permits to reduce dependency on real-time calls during transient latency.
* Monitor your own auth request latency and set alerts tuned to your critical user journeys.